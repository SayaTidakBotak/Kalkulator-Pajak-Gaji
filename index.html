<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Glass Tax 2025 â€“ Indonesia & United States (Working)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#007bff">
<link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;Glass Tax 2025&quot;,&quot;short_name&quot;:&quot;TaxCalc&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#ffffff&quot;,&quot;theme_color&quot;:&quot;#007bff&quot;}">
<style>
:root{--bg:#f0f4f8;--card:#ffffffcc;--text:#111;--accent:#007bff;--label:#555;--border:#cdd9ed;--shadow:0 12px 40px rgba(0,0,0,.1);--radius:18px;--transition:all .25s ease;}
@media (prefers-color-scheme: dark){:root{--bg:#121212;--card:#1e1e1ecc;--text:#f0f0f0;--accent:#0ebeff;--label:#aaa;--border:#333;--shadow:0 12px 40px rgba(0,0,0,.3);}}
*{box-sizing:border-box}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center;min-height:100vh;padding:1rem}
.card{width:100%;max-width:440px;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:2rem;backdrop-filter:blur(14px);border:1px solid var(--border);transition:var(--transition)}
h1{margin:0 0 .5rem;font-size:1.5rem;font-weight:700}
.sub{font-size:.8rem;color:var(--label);margin-bottom:1.5rem}
.country-toggle{display:flex;gap:.5rem;margin-bottom:1.5rem}
.country-toggle button{flex:1;padding:.6rem;border:1px solid var(--border);background:transparent;color:var(--text);border-radius:10px;cursor:pointer;font-size:.9rem;transition:var(--transition)}
.country-toggle button.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.field{margin-bottom:1.2rem}
label{display:block;font-size:.75rem;color:var(--label);margin-bottom:.25rem}
input,select{width:100%;padding:.8rem .6rem;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--text);font-size:1rem;transition:var(--transition)}
input:focus,select:focus{outline:none;border-color:var(--accent)}
button{width:100%;padding:.8rem;border:none;border-radius:10px;background:var(--accent);color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:var(--transition)}
button:hover{filter:brightness(1.1)}
#result{margin-top:1.5rem;font-size:1rem;line-height:1.7}
.hl{font-weight:700;color:var(--accent)}
</style>
</head>
<body>
<div class="card">
  <div class="country-toggle">
    <button id="btnID" class="active">ðŸ‡®ðŸ‡© Indonesia</button>
    <button id="btnUS">ðŸ‡ºðŸ‡¸ United States</button>
  </div>
  <h1 id="title">PPh 21 + Tapera 2025</h1>
  <div id="sub" class="sub">Hitung gaji bersih & biaya perusahaan</div>

  <div id="formArea">
    <!-- Indonesia form injected here -->
  </div>

  <div id="result"></div>
</div>

<script>
// ---------- LANG ----------
const tx={
  ID:{title:'PPh 21 + Tapera 2025',sub:'Hitung gaji bersih & biaya perusahaan'},
  US:{title:'U.S. Income Tax 2025',sub:'Federal + FICA + State (all 50 + DC)'}
};
let country=localStorage.getItem('country')||'ID';

// ---------- INDONESIA ENGINE ----------
const ptkpYear={A:54000000,B:63000000,C:72000000};
const bpjsKesCap={min:120000,max:12000000};
const bpjsJhtJpCap=10054700;
const posCostMax=500000;
const terA={0:0,4850000:0.005,5300000:0.01,5850000:0.015,6400000:0.02,6950000:0.025,7500000:0.03,8050000:0.035,8600000:0.04,9150000:0.045,9650000:0.05,10150000:0.055,10650000:0.06,11150000:0.065,11650000:0.07,12150000:0.075,12650000:0.08,13150000:0.085,13650000:0.09,14150000:0.095,14600000:0.1,15150000:0.105,15650000:0.11,16150000:0.115,16600000:0.12,17150000:0.125,17600000:0.13,18150000:0.135,18600000:0.14,19150000:0.145,19600000:0.15,20150000:0.155,20650000:0.16,21150000:0.165,21650000:0.17,22150000:0.175,22600000:0.18,23100000:0.185,23600000:0.19,24100000:0.195,24600000:0.2,25150000:0.205,25600000:0.21,26150000:0.215,26600000:0.22,27100000:0.225,27600000:0.23,28150000:0.235,28600000:0.24,29150000:0.245,29600000:0.25,30150000:0.255,30600000:0.26,31150000:0.265,31600000:0.27,32100000:0.275,32600000:0.28,33100000:0.285,33600000:0.29,34100000:0.295,34600000:0.3,35100000:0.305,35600000:0.31,36100000:0.315,36600000:0.32,37100000:0.325,37600000:0.33,38100000:0.335,38600000:0.34};

function idr(x){return 'Rp '+Math.round(x).toLocaleString('id');}
function hitungID(){
  const g=+document.getElementById('gross').value||0;
  const thr=+document.getElementById('thr').value||0;
  const st=document.getElementById('status').value;
  const mo=+document.getElementById('month').value;

  const bpjsKes=Math.min(Math.max(g,1200000),12000000)*0.01;
  const jht=Math.min(g,bpjsJhtJpCap)*0.02;
  const jp=Math.min(g,bpjsJhtJpCap)*0.01;
  const taperaEmp=g*0.025;
  const posCost=Math.min(0.05*g,500000);

  const tbl=st==='A'?terA:(st==='B'?terB:terC);
  const terRate=Object.keys(tbl).filter(k=>+k<=(g+thr)).pop()?tbl[Object.keys(tbl).filter(k=>+k<=(g+thr)).pop()]:0;
  let pph21=(g+thr)*terRate;
  if(mo===12){
    const annual=(g+thr)*12;
    const netOcc=(g-posCost)*12;
    const netBpjs=(jht+jp)*12;
    const netTapera=taperaEmp*12;
    const netIncome=annual-netOcc-netBpjs-netTapera;
    const pkp=Math.max(0,netIncome-ptkpYear[st]);
    let tax=0,temp=pkp;
    const brackets=[60000000,250000000,500000000,5000000000];
    const rates=[0.05,0.15,0.25,0.30,0.35];
    for(let i=0;i<brackets.length;i++){
      const tr=Math.min(temp,brackets[i]-(i>0?brackets[i-1]:0));
      tax+=tr*rates[i];
      temp-=tr;
      if(temp<=0)break;
    }
    if(temp>0)tax+=temp*rates[4];
    pph21=tax-terRate*(g+thr)*11;
  }
  const net=g-bpjsKes-jht-jp-taperaEmp-pph21;
  const empCost=g+(g*0.005)+(Math.min(g,12000000)*0.04)+(Math.min(g,bpjsJhtJpCap)*(0.037+0.002+0.003));
  document.getElementById('result').innerHTML=`<span class="hl">Take-home:</span> ${idr(net)}<br><span class="hl">PPh 21:</span> ${idr(pph21)}<br>BPJS Kes 1%: ${idr(bpjsKes)}<br>JHT 2%: ${idr(jht)} | JP 1%: ${idr(jp)}<br>Tapera 2.5%: ${idr(taperaEmp)}<br><br><span class="hl">Employer cost:</span> ${idr(empCost)} /bln`;
}

// ---------- U.S. ENGINE ----------
const fedBrackets={single:[0,11600,47150,100525,191950,243725,609350],mfj:[0,23200,94300,201050,383900,487450,731200],hoh:[0,16550,63100,100500,191950,243700,609350]};
const fedRates=[0.10,0.12,0.22,0.24,0.32,0.35,0.37];
const stdDed={single:15000,mfj:30000,hoh:22500};

const stateBrackets={
  CA:{brackets:[0,10798,25625,40346,54898,69274,86738,181215],rates:[1,2,4,6,8,9.3,10.3,12.3]},
  CT:{brackets:[0,10000,50000,100000,200000,500000],rates:[2,4.5,5.5,6,6.99]},
  DE:{brackets:[0,2000,5000,10000,20000,25000,60000],rates:[2.2,3.9,4.8,5.2,5.5,6.6]},
  HI:{brackets:[0,4800,9600,19200,36000,48000,150000],rates:[1.4,3.2,5.5,6.4,6.8,7.6,9,11]},
  IA:{brackets:[0,6794,20370,33950,61050],rates:[4.4,4.82,5.7,5.7]},
  KS:{brackets:[0,15000,30000],rates:[3.1,5.25,5.7]},
  LA:{brackets:[0,12500,50000],rates:[1.85,3.5,4.25]},
  ME:{brackets:[0,24900,58950],rates:[5.8,6.75,7.15]},
  MD:{brackets:[0,1000,2000,3000,100000,125000,150000],rates:[2,3,4,4.75,5,5.25,5.75]},
  MA:{brackets:[0,1000000],rates:[5,9]},
  MN:{brackets:[0,30070,98760,184390],rates:[5.35,6.8,7.85,9.85]},
  MO:{brackets:[0,1198,2396,3594,4792,5990,7188,9584,11980],rates:[2,2.5,3,3.5,4,4.5,5,5.3,5.4]},
  MT:{brackets:[0,3400,5800,8800,12000],rates:[4.7,5.9,6.75,7.1,7.4]},
  NB:{brackets:[0,3690,22970,35230],rates:[2.46,3.51,5.01,5.84]},
  NJ:{brackets:[0,20000,35000,40000,75000,500000],rates:[1.4,1.75,3.5,5.525,6.37,8.97,10.75]},
  NM:{brackets:[0,5500,11000,16000],rates:[1.7,3.2,4.7,5.9]},
  NY:{brackets:[0,8500,11700,13900,80650,215400],rates:[4,4.5,5.25,5.5,6,6.85,9.65,10.9]},
  ND:{brackets:[0,44725,108650],rates:[1.95,2.5,2.9]},
  OH:{brackets:[0,30500,61050],rates:[2.75,3.688,3.5]},
  OK:{brackets:[0,1000,2500,3750,4900],rates:[0.25,0.75,1.75,2.75,4.75]},
  OR:{brackets:[0,4450,11550,19550,125000],rates:[4.75,6.75,8.75,9.9]},
  RI:{brackets:[0,7150,54850],rates:[3.75,4.75,5.99]},
  SC:{brackets:[0,3230,16150],rates:[0,3,6]},
  VT:{brackets:[0,47450,114800],rates:[3.35,6.6,7.6,8.75]},
  VA:{brackets:[0,3000,5000,17000],rates:[2,3,5,5.75]},
  WI:{brackets:[0,14320,28640,315310],rates:[3.54,4.65,5.3,7.65]},
  DC:{brackets:[0,10000,40000,60000,350000],rates:[4,6,6.5,8.5,10.75]}
};

function usd(x){return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(x);}
function calcBracket(brackets,rates,income){
  let tax=0,temp=income;
  for(let i=0;i<brackets.length-1;i++){
    const tr=Math.min(temp,brackets[i+1]-brackets[i]);
    tax+=tr*rates[i]/100;
    temp-=tr;
    if(temp<=0)break;
  }
  if(temp>0)tax+=temp*rates[rates.length-1]/100;
  return tax;
}
function hitungUS(){
  const g=+document.getElementById('gross').value||0;
  const stOpt=document.getElementById('state').selectedOptions[0];
  const filing=document.getElementById('filing').value;

  const taxable=Math.max(0,g-stdDed[filing]);
  let fedTax=calcBracket(fedBrackets[filing],fedRates.map(r=>r*100),taxable);

  const ss=Math.min(g,176100)*0.062;
  const mc=g*0.0145+Math.max(0,g-200000)*0.009;
  const fica=ss+mc;

  let stTax=0;
  const stVal=stOpt.value;
  if(['AK','FL','NV','NH','SD','TN','TX','WA','WY'].includes(stVal)) stTax=0;
  else if(stVal.includes('%')){ const r=parseFloat(stVal.split('%')[0]); stTax=g*r/100; }
  else if(stateBrackets[stVal]){ stTax=calcBracket(stateBrackets[stVal].brackets,stateBrackets[stVal].rates,g); }

  const net=g-fedTax-fica-stTax;
  document.getElementById('result').innerHTML=`<span class="hl">Net pay:</span> ${usd(net)}<br><span class="hl">Federal:</span> ${usd(fedTax)}<br>FICA SS+Medicare: ${usd(fica)}<br>${stTax?`<span class="hl">State:</span> ${usd(stTax)}<br>`:''}Effective rate: ${((fedTax+fica+stTax)/g*100).toFixed(1)} %`;
}

// ---------- SWITCH ----------
const btnID=document.getElementById('btnID');
const btnUS=document.getElementById('btnUS');
const title=document.getElementById('title');
const sub=document.getElementById('sub');
const formArea=document.getElementById('formArea');

function renderCountry(){
  country=localStorage.getItem('country')||'ID';
  btnID.classList.toggle('active',country==='ID');
  btnUS.classList.toggle('active',country==='US');
  title.textContent=tx[country].title;
  sub.textContent=tx[country].sub;
  formArea.innerHTML=country==='ID'?idForm():usForm();
  if(country==='ID') hitungID(); else hitungUS();
}
btnID.onclick=()=>{localStorage.setItem('country','ID'); renderCountry();};
btnUS.onclick=()=>{localStorage.setItem('country','US'); renderCountry();};

function idForm(){
  return `
  <div class="field"><label>Annual gross wages (Rp)</label><input id="gross" type="number" min="0" step="100000" oninput="hitungID()"></div>
  <div class="field"><label>THR / Bonus bulan ini (Rp)</label><input id="thr" type="number" min="0" step="100000" value="0" oninput="hitungID()"></div>
  <div class="field"><label>Status PTKP (TER)</label><select id="status" onchange="hitungID()"><option value="A">A â€“ TK/0, TK/1, K/0</option><option value="B">B â€“ TK/2, TK/3, K/1, K/2</option><option value="C">C â€“ K/3</option></select></div>
  <div class="field"><label>Bulan berjalan</label><select id="month" onchange="hitungID()">${Array.from({length:12},(_,i)=>`<option value="${i+1}">${['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember (true-up)'][i]}</option>`).join('')}</select></div>
  <button onclick="hitungID()">Hitung â†’</button>`;
}
function usForm(){
  return `
  <div class="field"><label>Annual gross wages ($)</label><input id="gross" type="number" min="0" step="1000" placeholder="85000" oninput="hitungUS()"></div>
  <div class="field"><label>State</label><select id="state" onchange="hitungUS()">
    <optgroup label="No state tax"><option value="AK">Alaska</option><option value="FL">Florida</option><option value="NV">Nevada</option><option value="NH">New Hampshire (div/int only)</option><option value="SD">South Dakota</option><option value="TN">Tennessee (div/int only)</option><option value="TX">Texas</option><option value="WA">Washington (cap-gains only)</option><option value="WY">Wyoming</option></optgroup>
    <optgroup label="Flat rate"><option value="AZ2.5">Arizona 2.5 %</option><option value="CO4.4">Colorado 4.4 %</option><option value="GA5.49">Georgia 5.49 %</option><option value="ID5.8">Idaho 5.8 %</option><option value="IL4.9">Illinois 4.9 %</option><option value="IN3.05">Indiana 3.05 %</option><option value="KY4">Kentucky 4 %</option><option value="MI4.25">Michigan 4.25 %</option><option value="MS4.7">Mississippi 4.7 %</option><option value="NC4.5">North Carolina 4.5 %</option><option value="PA3.07">Pennsylvania 3.07 %</option><option value="UT4.65">Utah 4.65 %</option></optgroup>
    <optgroup label="Progressive"><option value="CA">California (1 %-13.3 %)</option><option value="CT">Connecticut (2 %-6.99 %)</option><option value="DE">Delaware (2.2 %-6.6 %)</option><option value="HI">Hawaii (1.4 %-11 %)</option><option value="IA">Iowa (4.4 %-5.7 %)</option><option value="KS">Kansas (3.1 %-5.7 %)</option><option value="LA">Louisiana (1.85 %-4.25 %)</option><option value="ME">Maine (5.8 %-7.15 %)</option><option value="MD">Maryland (2 %-5.75 %)</option><option value="MA">Massachusetts (5 %-9 %)</option><option value="MN">Minnesota (5.35 %-9.85 %)</option><option value="MO">Missouri (2 %-4.8 %)</option><option value="MT">Montana (4.7 %-5.9 %)</option><option value="NB">Nebraska (2.46 %-5.84 %)</option><option value="NJ">New Jersey (1.4 %-10.75 %)</option><option value="NM">New Mexico (1.7 %-5.9 %)</option><option value="NY">New York (4 %-10.9 %)</option><option value="ND">North Dakota (1.95 %-2.5 %)</option><option value="OH">Ohio (2.75 %-3.5 %)</option><option value="OK">Oklahoma (0.25 %-4.75 %)</option><option value="OR">Oregon (4.75 %-9.9 %)</option><option value="RI">Rhode Island (3.75 %-5.99 %)</option><option value="SC">South Carolina (0 %-6.4 %)</option><option value="VT">Vermont (3.35 %-8.75 %)</option><option value="VA">Virginia (2 %-5.75 %)</option><option value="WI">Wisconsin (3.54 %-7.65 %)</option><option value="DC">DC (4 %-10.75 %)</option></optgroup>
  </select></div>
  <div class="field"><label>Filing status</label><select id="filing" onchange="hitungUS()"><option value="single">Single</option><option value="mfj">Married Filing Jointly</option><option value="hoh">Head of Household</option></select></div>
  <button onclick="hitungUS()">Calculate â†’</button>`;
}

// initial
renderCountry();
</script>
</body>
</html>
